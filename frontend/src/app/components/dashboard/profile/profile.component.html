<div class="profile-container" id="profile-content">
  <h2>User Profile</h2>

  <mat-card class="section-card">
    <mat-card-header>
      <mat-card-title>My Crops</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="crops-list">
        <span *ngFor="let crop of myCrops" class="crop-tag">{{ crop }}</span>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="section-card">
    <mat-card-header>
      <mat-card-title>My Details</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Name</mat-label>
            <input matInput formControlName="name" required>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" type="email" required>
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Age</mat-label>
            <input matInput formControlName="age" type="number" required>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Region</mat-label>
            <input matInput formControlName="region" required>
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Mobile</mat-label>
            <input matInput formControlName="mobile">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Farm Size</mat-label>
            <input matInput formControlName="farmSize" placeholder="e.g., 5 acres" required>
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Experience</mat-label>
            <input matInput formControlName="experience" placeholder="e.g., 10 years" required>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Language</mat-label>
            <mat-select formControlName="language">
              <mat-option value="en">English</mat-option>
              <mat-option value="te">Telugu</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="form-row">
          <div class="photo-upload">
            <input type="file" (change)="onFileSelected($event)" accept="image/*" style="display: none;" #fileInput>
            <button mat-stroked-button type="button" (click)="fileInput.click()">
              <mat-icon>photo_camera</mat-icon>
              Upload Photo
            </button>
            <img *ngIf="user.profilePhoto" [src]="user.profilePhoto" alt="Profile Photo" class="profile-photo">
          </div>
        </div>
        <button mat-raised-button color="primary" type="submit" [disabled]="!profileForm.valid">
          Update Profile
        </button>
      </form>
    </mat-card-content>
  </mat-card>

  <mat-card class="section-card">
    <mat-card-header>
      <mat-card-title>Farmer Details</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="farmer-details">
        <p><strong>Age:</strong> {{ user.age }}</p>
        <p><strong>Farm Size:</strong> {{ user.farmSize }}</p>
        <p><strong>Experience:</strong> {{ user.experience }}</p>
        <p><strong>Language:</strong> {{ user.language === 'en' ? 'English' : 'Telugu' }}</p>
        <p><strong>Region:</strong> {{ user.region }}</p>
        <p><strong>Mobile:</strong> {{ user.mobile || 'Not provided' }}</p>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="download-section">
    <button mat-raised-button color="primary" (click)="downloadProfilePdf()">Download Profile PDF</button>
  </div>
</div>
